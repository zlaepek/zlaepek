name: Generate Language Trend Charts

on:
  schedule:
    # ë§¤ì›” 1ì¼ ì˜¤ì „ 9ì‹œ (í•œêµ­ì‹œê°„ ê¸°ì¤€, UTC 0ì‹œ)
    - cron: '0 0 1 * *'
  workflow_dispatch:
  push:
    branches: [ main ]
    paths:
      - '.github/workflows/generate-charts.yml'
      - 'monthly_data_*.json'

jobs:
  generate-charts:
    runs-on: ubuntu-latest
    # GitHub Actionì´ ë§Œë“  ì»¤ë°‹ì€ ì œì™¸
    if: ${{ !contains(github.event.head_commit.message, '[skip ci]') && github.event.head_commit.author.email != 'action@github.com' }}
    permissions:
      contents: write
      
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
          
      - name: Install Dependencies
        run: |
          pip install matplotlib seaborn pandas requests python-dateutil
          
      - name: Generate Language Trend Charts
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          USERNAME: ${{ github.repository_owner }}
        run: |
          cat > generate_charts.py << 'EOF'
          import matplotlib.pyplot as plt
          import seaborn as sns
          import pandas as pd
          import requests
          
          # í•œê¸€ í°íŠ¸ ì„¤ì •
          plt.rcParams['font.family'] = ['DejaVu Sans', 'Arial', 'sans-serif']
          plt.rcParams['axes.unicode_minus'] = False
          import json
          from datetime import datetime, timedelta
          import os
          from collections import defaultdict
          import numpy as np
          
          # matplotlib ì„¤ì • - í°íŠ¸ ë¬¸ì œ í•´ê²°
          import matplotlib
          matplotlib.use('Agg')
          matplotlib.rcParams['axes.unicode_minus'] = False
          matplotlib.rcParams['font.family'] = 'DejaVu Sans'
          
          # GitHub API ì„¤ì •
          GITHUB_TOKEN = os.environ['GITHUB_TOKEN']
          USERNAME = os.environ['USERNAME']
          
          headers = {
              'Authorization': f'token {GITHUB_TOKEN}',
              'Accept': 'application/vnd.github.v3+json'
          }
          
          # ì–¸ì–´ë³„ ìƒ‰ìƒ ë§¤í•‘ (ìƒˆë¡œìš´ ë¶„ì•¼ë³„ ìƒ‰ìƒ ì½”ë”©)
          language_colors = {
              # ì›¹ í”„ë¡ íŠ¸ì—”ë“œ (í•‘í¬ê³„ì—´)
              'JavaScript': '#FF69B4',  # í•«í•‘í¬
              'TypeScript': '#FF1493',  # ë”¥í•‘í¬
              'React': '#FFB3D9',       # ë¼ì´íŠ¸í•‘í¬
              'HTML': '#FFB6C1',        # ë¼ì´íŠ¸í•‘í¬
              'CSS': '#FFC0CB',         # í•‘í¬
              'Vue': '#FF91A4',         # í•‘í¬ ê³„ì—´

              # ìœ ë‹ˆí‹°/ê²Œì„ (ë³´ë¼ê³„ì—´ - ë©”ì¸)
              'C#': '#7469B6',          # ë©”ì¸ ë³´ë¼
              'Unity': '#7469B6',       # ë©”ì¸ ë³´ë¼
              'C++': '#8B7EC8',         # ë¼ì´íŠ¸ ë³´ë¼

              # ë°±ì—”ë“œ (ë¸”ë£¨ê³„ì—´)
              'Java': '#4A90E2',        # ì§„í•œ íŒŒë‘
              'Python': '#74C0FC',      # ë°ì€ íŒŒë‘
              'Node.js': '#6495ED',     # ì½”ë¥¸í”Œë¼ì›Œ ë¸”ë£¨
              'AWS': '#87CEEB',         # ìŠ¤ì¹´ì´ ë¸”ë£¨
              'PHP': '#5DADE2',         # ë¼ì´íŠ¸ ë¸”ë£¨
              'Go': '#3498DB',          # ë„ì§€ ë¸”ë£¨

              # DevOps/ê¸°íƒ€
              'Docker': '#2496ED',      # ë„ì»¤ ë¸”ë£¨
              'Rust': '#FF6B35',        # ëŸ¬ìŠ¤íŠ¸ ì˜¤ë Œì§€
              'Swift': '#FA7343',       # ìŠ¤ìœ„í”„íŠ¸ ì˜¤ë Œì§€
              'Kotlin': '#7F52FF'       # ì½”í‹€ë¦° í¼í”Œ
          }
          
          def get_monthly_language_data():
              """ì§€ë‚œ 12ê°œì›”ê°„ ì–¸ì–´ë³„ ì‚¬ìš©ë¥  ë°ì´í„° ìˆ˜ì§‘"""
              print("ğŸ“Š ì›”ë³„ ì–¸ì–´ ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘...")
              
              # 2020ë…„ë¶€í„° í˜„ì¬ê¹Œì§€ ëª¨ë“  ì›” ìƒì„±
              months = []
              current_date = datetime.now()
              start_date = datetime(2020, 1, 1)
              
              temp_date = start_date
              while temp_date <= current_date:
                  months.append(temp_date.strftime('%Y-%m'))
                  # ë‹¤ìŒ ì›”ë¡œ ì´ë™
                  if temp_date.month == 12:
                      temp_date = temp_date.replace(year=temp_date.year + 1, month=1)
                  else:
                      temp_date = temp_date.replace(month=temp_date.month + 1)
              
              # ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ìœ„í•´ ê¸°ì¡´ íŒŒì¼ ì‚­ì œ
              import os
              current_year = datetime.now().year
              
              for year in range(current_year - 3, current_year + 1):
                  filename = f'monthly_data_{year}.json'
                  if os.path.exists(filename):
                      os.remove(filename)
                      print(f"ğŸ—‘ï¸  ê¸°ì¡´ {year}ë…„ ë°ì´í„° íŒŒì¼ ì‚­ì œ")
              
              saved_data = {}
              
              # ì›”ë³„ ì–¸ì–´ ë°ì´í„° ì €ì¥
              monthly_data = defaultdict(lambda: defaultdict(int))
              
              try:
                  # ì‚¬ìš©ìì˜ ëª¨ë“  ë¦¬í¬ì§€í† ë¦¬ ê°€ì ¸ì˜¤ê¸°
                  repos_response = requests.get(
                      f'https://api.github.com/users/{USERNAME}/repos?per_page=100&sort=created',
                      headers=headers
                  )
                  repos = repos_response.json()
                  
                  # ëª¨ë“  ì›”ì— ëŒ€í•´ ê· ë“±í•˜ê²Œ ë°ì´í„° ë°°ë¶„
                  for repo in repos:
                      if repo['fork']:
                          continue
                          
                      print(f"ë¶„ì„ ì¤‘: {repo['name']}")
                      
                      # ê° ë¦¬í¬ì§€í† ë¦¬ì˜ ì–¸ì–´ í†µê³„
                      try:
                          lang_response = requests.get(
                              f"https://api.github.com/repos/{USERNAME}/{repo['name']}/languages",
                              headers=headers
                          )
                          languages = lang_response.json()
                          
                          if languages:
                              # ë¦¬í¬ì§€í† ë¦¬ ìƒì„±ì¼ê³¼ ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í™œë™ ê¸°ê°„ ê³„ì‚°
                              created_at = datetime.strptime(repo['created_at'], '%Y-%m-%dT%H:%M:%SZ')
                              updated_at = datetime.strptime(repo['updated_at'], '%Y-%m-%dT%H:%M:%SZ')
                              
                              # ë¦¬í¬ì§€í† ë¦¬ê°€ í™œë™í•œ ëª¨ë“  ì›”ì— ì–¸ì–´ ë°ì´í„° ì¶”ê°€
                              for month in months:
                                  month_date = datetime.strptime(month + '-01', '%Y-%m-%d')
                                  
                                  # ë¦¬í¬ì§€í† ë¦¬ê°€ í•´ë‹¹ ì›”ì— ì¡´ì¬í–ˆë‹¤ë©´ ë°ì´í„° ì¶”ê°€
                                  if created_at <= month_date <= updated_at:
                                      # ì œì™¸í•  ì–¸ì–´ë“¤
                                      exclude_languages = ['ShaderLab', 'HLSL', 'Makefile', 'Batchfile', 'Shell']
                                      
                                      for lang, bytes_count in languages.items():
                                          # ì œì™¸ ì–¸ì–´ëŠ” ê±´ë„ˆë›°ê¸°
                                          if lang in exclude_languages:
                                              continue
                                          # ëŒ€ëµì ì¸ ì¤„ ìˆ˜ë¡œ ë³€í™˜ (í‰ê·  50 ë°”ì´íŠ¸ = 1ì¤„)
                                          lines_estimate = bytes_count // 50
                                          monthly_data[month][lang] += lines_estimate
                                  
                      except Exception as e:
                          print(f"ì–¸ì–´ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨ {repo['name']}: {e}")
                          continue
                          
              except Exception as e:
                  print(f"ë¦¬í¬ì§€í† ë¦¬ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨: {e}")
                  
              # ìˆ˜ì§‘ëœ ëª¨ë“  ë°ì´í„°ê°€ monthly_dataì— ìˆìœ¼ë¯€ë¡œ ê·¸ëŒ€ë¡œ ì‚¬ìš©
              
              # ë°ì´í„°ê°€ ë¶€ì¡±í•œ ê²½ìš° ê²½ê³ ë§Œ í‘œì‹œ
              if len(monthly_data) < 6:  # 6ê°œì›” ì´í•˜ ë°ì´í„°ë©´ ê²½ê³ 
                  print("âš ï¸  ì‹¤ì œ ë°ì´í„°ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤ (6ê°œì›” ë¯¸ë§Œ)")
              
              # ì—°ë„ë³„ë¡œ ë°ì´í„° ë¶„ë¦¬ ì €ì¥
              try:
                  years_data = {}
                  for month, data in monthly_data.items():
                      year = month.split('-')[0]
                      if year not in years_data:
                          years_data[year] = {}
                      years_data[year][month] = data
                  
                  # ê° ì—°ë„ë³„ íŒŒì¼ë¡œ ì €ì¥
                  for year, year_data in years_data.items():
                      filename = f'monthly_data_{year}.json'
                      with open(filename, 'w') as f:
                          json.dump(year_data, f, indent=2)
                      print(f"ğŸ’¾ {year}ë…„ ë°ì´í„° ì €ì¥ ì™„ë£Œ: {filename}")
                      
              except Exception as e:
                  print(f"âš ï¸  ë°ì´í„° ì €ì¥ ì‹¤íŒ¨: {e}")
              
              return months, monthly_data
          
          def generate_sample_data(months):
              """ìƒ˜í”Œ ë°ì´í„° ìƒì„± (ì‹¤ì œ ë°ì´í„°ê°€ ì—†ì„ ë•Œ)"""
              languages = ['C#', 'JavaScript', 'Python', 'TypeScript', 'HTML', 'CSS']
              sample_data = defaultdict(lambda: defaultdict(int))
              
              # 2020ë…„ë¶€í„° í˜„ì¬ê¹Œì§€ ì‹¤ì œ ê°œë°œ íˆìŠ¤í† ë¦¬ ë°˜ì˜ (ì¤„ ìˆ˜ ê¸°ì¤€)
              base_values = {
                  'C#': 1000,      # Unity ê°œë°œ ì£¼ë ¥ (1000ì¤„)
                  'JavaScript': 400, # ì ì§„ì  ì¦ê°€ (400ì¤„)
                  'Python': 300,  # ëŒ€í•™ + PTAHLABS (300ì¤„)
                  'Java': 600,    # ëŒ€í•™ ì‹œì ˆ ì£¼ë ¥ (600ì¤„)
                  'TypeScript': 100, # ìµœê·¼ ë„ì… (100ì¤„)
                  'HTML': 160,    # ì›¹ ê°œë°œ (160ì¤„)
                  'CSS': 120       # ì›¹ ê°œë°œ (120ì¤„)
              }
              
              for i, month in enumerate(months):
                  year_month = month.split('-')
                  year = int(year_month[0])
                  month_num = int(year_month[1])
                  
                  for lang in languages:
                      base = base_values[lang]
                      
                      # ì—°ë„ë³„ ê¸°ìˆ  ìŠ¤íƒ ë³€í™” ë°˜ì˜
                      if year == 2020:  # ëŒ€í•™ 1ë…„ì°¨
                          if lang == 'Java': value = base * 1.5  # ëŒ€í•™ ì»¤ë¦¬í˜ëŸ¼
                          elif lang == 'Python': value = base * 0.8
                          elif lang == 'C#': value = base * 0.2  # ì•„ì§ Unity ì „
                          else: value = base * 0.3
                      elif year == 2021:  # ëŒ€í•™ 2ë…„ì°¨
                          if lang == 'Java': value = base * 1.3
                          elif lang == 'Python': value = base * 1.0
                          elif lang == 'C#': value = base * 0.4  # Unity ì…ë¬¸
                          else: value = base * 0.4
                      elif year == 2022:  # ëŒ€í•™ 3ë…„ì°¨
                          if lang == 'Java': value = base * 1.0
                          elif lang == 'C#': value = base * 0.7  # Unity ë³¸ê²© ì‹œì‘
                          elif lang == 'Python': value = base * 0.9
                          else: value = base * 0.5
                      elif year == 2023:  # ë””ìºë¦­ ì…ì‚¬
                          if lang == 'C#': value = base * 1.4  # Unity ì „ë¬¸ê°€
                          elif lang == 'Java': value = base * 0.3  # ì‚¬ìš© ì¤‘ë‹¨
                          elif lang in ['JavaScript', 'HTML', 'CSS']: value = base * 0.4
                          else: value = base * 0.8
                      elif year == 2024 and month_num <= 10:  # ë””ìºë¦­ ë§ˆì§€ë§‰
                          if lang == 'C#': value = base * 1.3
                          elif lang in ['JavaScript', 'HTML', 'CSS']: value = base * 0.6  # ì›¹ í•™ìŠµ ì‹œì‘
                          elif lang == 'Python': value = base * 1.1
                          else: value = base * 0.9
                      else:  # PTAHLABS ì‹œëŒ€ (2024.11~)
                          if lang in ['JavaScript', 'HTML', 'CSS']: value = base * 2.2  # ì›¹ ì „í™˜
                          elif lang == 'Python': value = base * 1.8  # ë°±ì—”ë“œ
                          elif lang == 'TypeScript': value = base * 3.0  # ìƒˆ ê¸°ìˆ 
                          elif lang == 'C#': value = base * 0.5  # ë¹„ì¤‘ ê°ì†Œ
                          else: value = base * 0.4
                      
                      # ì‹œê°„ì— ë”°ë¥¸ ìì—°ìŠ¤ëŸ¬ìš´ ë³€í™” ì¶”ê°€ (ì¤„ ìˆ˜)
                      time_factor = i * 2  # ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ì•½ê°„ì”© ë³€í™”
                      noise = np.random.normal(0, 10)  # ëœë¤ ë…¸ì´ì¦ˆ
                      final_value = max(10, int(value + time_factor + noise))  # ìµœì†Œ 10ì¤„
                      
                      sample_data[month][lang] = final_value
              
              return sample_data
          
          def create_trend_chart(months, monthly_data):
              """ì–¸ì–´ íŠ¸ë Œë“œ ì°¨íŠ¸ ìƒì„±"""
              print("ğŸ¨ íŠ¸ë Œë“œ ì°¨íŠ¸ ìƒì„± ì¤‘...")
              
              # 2025ë…„ ë°ì´í„°ë§Œ í‘œì‹œ
              display_months = [month for month in months if month.startswith('2025')]
              display_data = {month: monthly_data[month] for month in display_months if month in monthly_data}
              
              # ìŠ¤íƒ€ì¼ ì„¤ì • (ëª¨ë˜ ë””ìì¸)
              plt.style.use('dark_background')
              
              fig, ax = plt.subplots(figsize=(16, 10))
              fig.patch.set_facecolor('#0d1117')  # GitHub ë‹¤í¬ ë°°ê²½
              ax.set_facecolor('#161b22')         # ì•½ê°„ ë°ì€ ì°¨íŠ¸ ë°°ê²½
              
              # ì£¼ìš” ì–¸ì–´ë“¤ë§Œ ì„ íƒ (í‘œì‹œí•  ë°ì´í„°ì—ì„œ)
              all_languages = set()
              for month_data in display_data.values():
                  all_languages.update(month_data.keys())
              
              # í‰ê·  ì‚¬ìš©ë¥ ë¡œ ì •ë ¬í•´ì„œ ìƒìœ„ 5ê°œ ì–¸ì–´ë§Œ
              lang_averages = {}
              for lang in all_languages:
                  values = [display_data.get(month, {}).get(lang, 0) for month in display_months]
                  lang_averages[lang] = sum(values) / len(values) if values else 0
              
              top_languages = sorted(lang_averages.items(), key=lambda x: x[1], reverse=True)[:5]
              
              # ë¶„ì•¼ë³„ë¡œ ì–¸ì–´ ê·¸ë£¹í™”
              game_langs = ['C#', 'Unity', 'C++']
              web_langs = ['JavaScript', 'TypeScript', 'HTML', 'CSS', 'React', 'Vue']
              
              # ëª¨ë“  ì–¸ì–´ë¥¼ í•˜ë‚˜ì”© ê·¸ë¦¬ê¸° (ë¶„ì•¼ë³„ ë¶„ë¥˜ ì œê±°)
              for lang, _ in top_languages:
                  line_values = [display_data.get(month, {}).get(lang, 0) for month in display_months]

                  # ë¶„ì•¼ë³„ ìƒ‰ìƒê³¼ ë§ˆì»¤ ì„¤ì •
                  if lang in web_langs:
                      color = language_colors.get(lang, '#FF69B4')
                      marker = 'o'
                  elif lang in game_langs:
                      color = language_colors.get(lang, '#7469B6')
                      marker = 's'
                  elif lang in ['Python', 'Java', 'Node.js', 'AWS']:
                      color = language_colors.get(lang, '#4A90E2')
                      marker = '^'
                  else:
                      color = language_colors.get(lang, '#95A5A6')
                      marker = 'D'

                  ax.plot(range(len(display_months)), line_values,
                         marker=marker, linewidth=3, markersize=8,
                         label=lang, color=color, alpha=0.9, linestyle='-')
              
              # ì›” ì´ë¦„ì„ ì˜ì–´ë¡œ ë³€í™˜
              month_names = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                           'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
              
              # ì°¨íŠ¸ ìŠ¤íƒ€ì¼ë§
              ax.set_xticks(range(len(display_months)))
              month_labels = []
              for month in display_months:
                  year, month_num = month.split('-')
                  month_name = month_names[int(month_num) - 1]
                  month_labels.append(f'{month_name} {year[2:]}')

              ax.set_xticklabels(month_labels, color='#f0f6fc', fontsize=14, rotation=45, fontweight='600')
              ax.set_ylabel('Lines of Code', color='#AD88C6', fontsize=16, fontweight='bold', labelpad=20)
              ax.set_title('2025 Programming Language Usage Trends', color='#f0f6fc',
                          fontsize=22, fontweight='bold', pad=40)
              
              # ê°œì„ ëœ ê·¸ë¦¬ë“œì™€ ë²”ë¡€
              ax.grid(True, alpha=0.15, color='#30363d', linestyle='-', linewidth=1)
              ax.legend(loc='upper left', frameon=True, fancybox=True, 
                       shadow=False, ncol=1, fontsize=11, 
                       facecolor='#21262d', edgecolor='#7c3aed', framealpha=0.95,
                       borderpad=1.5, columnspacing=2)
              
              # ì¶• ìƒ‰ìƒ ë° ìŠ¤íƒ€ì¼
              ax.tick_params(axis='y', colors='#f0f6fc', labelsize=12)
              ax.tick_params(axis='x', colors='#f0f6fc', labelsize=12)
              ax.spines['bottom'].set_color('#30363d')
              ax.spines['left'].set_color('#30363d')
              ax.spines['top'].set_visible(False)
              ax.spines['right'].set_visible(False)
              ax.spines['bottom'].set_linewidth(2)
              ax.spines['left'].set_linewidth(2)
              
              # Yì¶• ë²”ìœ„ ìë™ ì„¤ì • (ë°ì´í„°ì— ë”°ë¼)
              if display_data:
                  all_values = []
                  for month_data in display_data.values():
                      all_values.extend(month_data.values())
                  if all_values:
                      max_val = max(all_values)
                      ax.set_ylim(0, max_val * 1.1)  # 10% ì—¬ìœ  ê³µê°„
              
              plt.tight_layout(pad=3.5)
              plt.savefig('language_trend_chart.png', dpi=300, bbox_inches='tight',
                         facecolor='#0d1117', edgecolor='none')
              plt.close()
              
              print("âœ… ì°¨íŠ¸ ìƒì„± ì™„ë£Œ: language_trend_chart.png")
          
          def create_yearly_chart(months, monthly_data):
              """ì—°ë„ë³„ ì–¸ì–´ ì‚¬ìš©ëŸ‰ ì°¨íŠ¸ ìƒì„± (Xì¶•: ì—°ë„, Yì¶•: ì–¸ì–´ë³„ ë§‰ëŒ€)"""
              print("ğŸ“Š ì—°ë„ë³„ ì–¸ì–´ ì‚¬ìš©ëŸ‰ ì°¨íŠ¸ ìƒì„± ì¤‘...")

              # ì—°ë„ë³„ë¡œ ë°ì´í„° ì§‘ê³„
              yearly_data = defaultdict(lambda: defaultdict(int))

              for month, lang_data in monthly_data.items():
                  year = month.split('-')[0]
                  for lang, lines in lang_data.items():
                      yearly_data[year][lang] += lines

              # ì—°ë„ì™€ ì£¼ìš” ì–¸ì–´ ì¶”ì¶œ
              years = sorted(yearly_data.keys())
              all_languages = set()
              for year_data in yearly_data.values():
                  all_languages.update(year_data.keys())

              # ì œì™¸í•  ì–¸ì–´ í•„í„°ë§
              exclude_languages = ['ShaderLab', 'HLSL', 'Makefile', 'Batchfile', 'Shell']
              lang_totals = defaultdict(int)
              for year_data in yearly_data.values():
                  for lang, lines in year_data.items():
                      if lang not in exclude_languages:
                          lang_totals[lang] += lines

              # ìƒìœ„ ì–¸ì–´ë§Œ ì„ íƒ (ì´ ì‚¬ìš©ëŸ‰ ê¸°ì¤€)
              top_languages = sorted(lang_totals.items(), key=lambda x: x[1], reverse=True)[:6]
              top_lang_names = [lang for lang, _ in top_languages]

              # ì°¨íŠ¸ ì„¤ì • (ê°€ë¡œí˜• - Xì¶•: ì—°ë„, Yì¶•: ì–¸ì–´ë³„ ë§‰ëŒ€)
              plt.style.use('dark_background')
              fig, ax = plt.subplots(figsize=(12, 10))
              fig.patch.set_facecolor('#0d1117')
              ax.set_facecolor('#161b22')

              # ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì°¨íŠ¸ ìƒì„± ê±´ë„ˆë›°ê¸°
              if not years or not top_lang_names:
                  print("âš ï¸  ì—°ë„ë³„ ë°ì´í„° ì—†ìŒ, ì°¨íŠ¸ ìƒì„± ê±´ë„ˆëœ€")
                  plt.close()
                  return

              # ë¶„ì•¼ë³„ ì–¸ì–´ ë¶„ë¥˜
              game_langs = ['C#', 'Unity', 'UnityScript', 'C++']
              web_langs = ['JavaScript', 'TypeScript', 'HTML', 'CSS', 'React', 'Vue', 'Angular']
              backend_langs = ['Python', 'Java', 'Node.js', 'AWS']

              # ì—°ë„ë³„ x ìœ„ì¹˜ ì„¤ì • (Xì¶•ì´ ì—°ë„)
              x_pos = np.arange(len(years))
              bar_height = 0.12  # ë§‰ëŒ€ ë†’ì´

              # ì–¸ì–´ë³„ë¡œ ì„¸ë¡œ ë§‰ëŒ€ ì°¨íŠ¸ ìƒì„± (ì—°ë„ë³„ ê·¸ë£¹í™”)
              bar_width = 0.12
              for lang_idx, lang in enumerate(top_lang_names):
                  values = []

                  # ê° ì—°ë„ë³„ ê°’ ìˆ˜ì§‘
                  for year in years:
                      value = yearly_data[year].get(lang, 0)
                      values.append(value)

                  # ë¶„ì•¼ë³„ ìƒ‰ìƒ ì„¤ì •
                  if lang in game_langs:
                      color = language_colors.get(lang, '#7469B6')
                  elif lang in web_langs:
                      color = language_colors.get(lang, '#FF69B4')
                  elif lang in backend_langs:
                      color = language_colors.get(lang, '#4A90E2')
                  else:
                      color = language_colors.get(lang, '#95A5A6')

                  # X ìœ„ì¹˜ ê³„ì‚° (ì–¸ì–´ë³„ë¡œ ì˜¤í”„ì…‹ ì ìš©)
                  x_positions = x_pos + lang_idx * bar_width - bar_width * (len(top_lang_names) - 1) / 2

                  # ì„¸ë¡œ ë§‰ëŒ€ ì°¨íŠ¸ ìƒì„±
                  bars = ax.bar(x_positions, values, bar_width,
                               color=color, alpha=0.8, label=lang, edgecolor='none')

              # ì°¨íŠ¸ ìŠ¤íƒ€ì¼ë§ (ì„¸ë¡œí˜•)
              ax.set_xlabel('Years', color='#AD88C6', fontsize=16, fontweight='bold', labelpad=20)
              ax.set_ylabel('Lines of Code', color='#AD88C6', fontsize=16, fontweight='bold', labelpad=20)
              ax.set_title('Yearly Language Usage by Technology Stack', color='#f0f6fc',
                          fontsize=22, fontweight='bold', pad=40)

              # Xì¶• ì„¤ì • (ì—°ë„)
              ax.set_xticks(x_pos)
              ax.set_xticklabels(years, color='#f0f6fc', fontsize=14, fontweight='600')

              # Yì¶• ìë™ ì¡°ì •
              max_values = []
              for lang in top_lang_names:
                  for year in years:
                      max_values.append(yearly_data[year].get(lang, 0))
              if max_values:
                  ax.set_ylim(0, max(max_values) * 1.15)

              # ë²”ë¡€ ì„¤ì • (ì–¸ì–´ë³„)
              ax.legend(loc='upper left', frameon=True, fancybox=True,
                       shadow=False, ncol=2, fontsize=10,
                       facecolor='#21262d', edgecolor='#7c3aed', framealpha=0.95,
                       borderpad=1, columnspacing=1.5)

              # ê·¸ë¦¬ë“œ ì„¤ì •
              ax.grid(True, alpha=0.15, color='#30363d', linestyle='-', linewidth=1, axis='y')

              # ì¶• ìƒ‰ìƒ ë° ìŠ¤íƒ€ì¼
              ax.tick_params(axis='both', colors='#f0f6fc', labelsize=12)
              ax.spines['bottom'].set_color('#30363d')
              ax.spines['left'].set_color('#30363d')
              ax.spines['top'].set_visible(False)
              ax.spines['right'].set_visible(False)
              ax.spines['bottom'].set_linewidth(2)
              ax.spines['left'].set_linewidth(2)

              plt.tight_layout(pad=3.5)
              plt.savefig('language_yearly_chart.png', dpi=300, bbox_inches='tight',
                         facecolor='#0d1117', edgecolor='none')
              plt.close()

              print("âœ… ì—°ë„ë³„ ì°¨íŠ¸ ìƒì„± ì™„ë£Œ: language_yearly_chart.png")
          
          def main():
              print("ğŸš€ ì–¸ì–´ íŠ¸ë Œë“œ ì°¨íŠ¸ ìƒì„± ì‹œì‘...")
              
              months, monthly_data = get_monthly_language_data()
              
              if monthly_data:
                  create_trend_chart(months, monthly_data)
                  create_yearly_chart(months, monthly_data)
                  
                  print("ğŸ‰ ëª¨ë“  ì°¨íŠ¸ ìƒì„± ì™„ë£Œ!")
                  print("ğŸ“ ìƒì„±ëœ íŒŒì¼:")
                  print("  - language_trend_chart.png")
                  print("  - language_yearly_chart.png")
              else:
                  print("âŒ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ì–´ì„œ ì°¨íŠ¸ ìƒì„± ì‹¤íŒ¨")
          
          if __name__ == "__main__":
              main()
          EOF
          
          python generate_charts.py
          
      - name: Update README with Charts
        run: |
          # READMEì— ì°¨íŠ¸ ì´ë¯¸ì§€ ë§í¬ ì—…ë°ì´íŠ¸
          if [ -f "language_trend_chart.png" ]; then
            # ì´ë¯¸ì§€ë¥¼ assets í´ë”ë¡œ ì´ë™
            mkdir -p assets
            mv language_trend_chart.png assets/
            mv language_yearly_chart.png assets/
            
            # README ì—…ë°ì´íŠ¸
            sed -i 's|<!-- TREND_CHART -->.*<!-- /TREND_CHART -->|<!-- TREND_CHART -->\n![Language Trends](./assets/language_trend_chart.png)\n<!-- /TREND_CHART -->|g' README.md
            
            echo "âœ… README ì—…ë°ì´íŠ¸ ì™„ë£Œ"
          fi
          
      - name: Commit and Push Charts
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git pull origin main
          git add assets/ README.md monthly_data_*.json
          git diff --staged --quiet || git commit -m "Update language trend charts [skip ci]"
          git push